---
import Base from "../layouts/Base.astro";
import TopoDots from "../components/TopoDots.astro";
import FiveImageSequencer from "../components/FiveImageSequencer.astro";
import BottomArrow from "../components/BottomArrow.astro";
import ScrollSpacer from "../components/ScrollSpacer.astro";
import HoldEnterButton from "../components/HoldEnterButton.astro";
import ChoiceCarousel from "../components/ChoiceCarousel.astro";

import img1 from "../assets/photos/font_1.png";
import img2 from "../assets/photos/font_2.png";
import img3 from "../assets/photos/font_3.png";
import img4 from "../assets/photos/font_4.png";
import img5 from "../assets/photos/font_5.png";
import overlay1 from "../assets/photos/tv overlay_2.gif";
import overlay2 from "../assets/photos/tv overlay.png";
import opt1 from "../assets/photos/filefolder.avif";
import opt2 from "../assets/photos/music.png";
import opt3 from "../assets/photos/voicerecordings.jpg";
import rightIcon from "../assets/photos/lock.png";
import arrowblack from "../assets/photos/arrow_white.png";

/* overlay transform (applies to both overlay image and the slot) */
const overlayScaleX = 0.9;
const overlayScaleY = 1.7;

/* TV screen slot (calibrate these 4) */
const screenLeft   = '34.5%';
const screenTop    = '21%';
const screenWidth  = '30%';
const screenHeight = '40%';

/* carousel items */
const items = [
  { src: opt1.src, href: "/projects",   label: "Projects" },
  { src: opt2.src, href: "/music",      label: "Music"    },
  { src: opt3.src, href: "/voicememos", label: "Voice Memos" },
];
const sources = [img1, img2, img3, img4, img5];
const seqConfig = [
  { x: 0, y: 0, baseScale: 1 },
  { x: 0, y: 0, baseScale: 1 },
  { x: 0, y: 0, baseScale: 1 },
  { x: 0, y: 0, baseScale: 1 },
  { x: 0, y: 0, baseScale: 1 },
];
---

<Base title="portfoliov1" description="projects">
  <section class="relative h-[130vh] px-4 md:px-8 lg:px-12 py-12">
    <TopoDots
      spacing={24.5}
      amp={14}
      sigma={120}
      falloff="exp"
      chromaEnabled={true}
      chromaMode="lighter"
      rOffsetX={1.2} rOffsetY={0}
      gOffsetX={-2.5} gOffsetY={1.0}
      bOffsetX={-1.5} bOffsetY={0}
      targetFPS={60}
      dprCap={2}
      maxDots={9000}
      ariaHidden={true}
      chromaStrength={15.0}
    />

    <div class="absolute inset-0 z-20 pointer-events-none translate-y-[20%] md:translate-y-[-11.8%]">
      <FiveImageSequencer
        sources={sources}
        fps={24}
        config={seqConfig}
        class="w-full h-full"
      />
    </div>
    <BottomArrow
      amp="10px"
      period="1.4s"
      scale={2.75}
      bottom="25%"
      z={60}
      width="64px"
      hideAtPx={500}    
      fadeSpanPx={180}  
    />
  </section>
</Base>

<ScrollSpacer size="120vh" />

<section id="enter-stage" class="relative h-[60vh]">
  <!-- Co-transform overlay and slot so alignment never drifts -->
  <div class="overlay-group absolute inset-0 origin-top" style={`transform: scale(${overlayScaleX}, ${overlayScaleY});`}>
    <img
      src={overlay1.src /* or overlayPng */}
      alt=""
      class="absolute inset-0 w-full h-full object-fill pointer-events-none z-0"
    />

    <!-- Your calibrated TV screen slot (clip if you want nothing outside) -->
    <div class="tv-screen absolute z-[1]"
         style={`left:${screenLeft}; top:${screenTop}; width:${screenWidth}; height:${screenHeight}; `}>

      <ChoiceCarousel
        class="fill-slot-center"
        targetSelector="#enter-stage"
        items={items}
        leftArrow={arrowblack}
        rightArrow={arrowblack}

        top="0" left="0" right="0" bottom="0"
        centerX={false} centerY={false}
        offsetX="0" offsetY="0"

        mode="fill"
        frameMaxWidth="100%"
        frameRadius={12}

        leftX="-106%"  leftY="345%"  leftScale={5.05}
        rightX="106%"  rightY="350%"  rightScale={5.05}
        arrowButtonSize="56px"
        arrowIconWidth="34px"

        navigateOnClick={false}
        enablePreload={true}
      />
    </div>
  </div>

  <HoldEnterButton
    durationMs={1000}
    targetSelector="#enter-stage"
    label="ENTER"
    strokeRadius={10}
    hideOnComplete={true}
    icon={rightIcon}
    strokeStart="bottom-center"
  />
</section>

<ScrollSpacer size="50vh" />

<style is:global>
  /* Simple centering helper; no sizing overrides */
  .fill-slot-center{ display:grid; place-items:center; height:100%; }
</style>
