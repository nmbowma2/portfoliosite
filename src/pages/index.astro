---
import Base from "../layouts/Base.astro";
import TopoDots from "../components/TopoDots.astro";
import FiveImageSequencer from "../components/FiveImageSequencer.astro";
import BottomArrow from "../components/BottomArrow.astro";
import ScrollSpacer from "../components/ScrollSpacer.astro";
import HoldEnterButton from "../components/HoldEnterButton.astro";
import ChoiceCarousel from "../components/ChoiceCarousel.astro";

import img1 from "../assets/photos/font_1.png";
import img2 from "../assets/photos/font_2.png";
import img3 from "../assets/photos/font_3.png";
import img4 from "../assets/photos/font_4.png";
import img5 from "../assets/photos/font_5.png";
import overlay1 from "../assets/photos/tv overlay_2.gif";
import overlay2 from "../assets/photos/tv overlay.png";
import rightIcon from "../assets/photos/lock.png";
import opt4 from "../assets/photos/videos.png"
import opt2 from "../assets/photos/music.png"
import opt3 from "../assets/photos/picture.png"
import bigarrow from "../assets/photos/arrow_white.png"

const screenLeft   = '34.5%';
const screenTop    = '21%';
const screenWidth  = '30%';
const screenHeight = '40%';

const withBase = (p: string) => import.meta.env.BASE_URL + p.replace(/^\//, '');

/* carousel items */
const items = [
  { src: opt4.src, href: withBase("videos/"), label: "videos" },
  { src: opt2.src, href: withBase("music/"),  label: "Music"  },
  { src: opt3.src, href: withBase("photos/"), label: "photos" },
];
const sources = [img1, img2, img3, img4, img5];
const seqConfig = [
  { x: 0, y: 0, baseScale: 1 },
  { x: 0, y: 0, baseScale: 1 },
  { x: 0, y: 0, baseScale: 1 },
  { x: 0, y: 0, baseScale: 1 },
  { x: 0, y: 0, baseScale: 1 },
];
---
<!-- Place this near the top of index.astro -->
<Base title="portfoliov1" description="projects">
  <section class="relative h-[130vh] px-4 md:px-8 lg:px-12 py-12">
    <TopoDots
      spacing={24.5}
      amp={14}
      sigma={120}
      falloff="exp"
      chromaEnabled={true}
      chromaMode="lighter"
      rOffsetX={1.2} rOffsetY={0}
      gOffsetX={-2.5} gOffsetY={1.0}
      bOffsetX={-1.5} bOffsetY={0}
      targetFPS={60}
      dprCap={2}
      maxDots={9000}
      ariaHidden={true}
      chromaStrength={15.0}
    />

    <BottomArrow
      amp="10px"
      period="1.4s"
      scale={2.75}
      bottom="3.5%"
      z={60}
      width="64px"
      hideAtPx="50%"    
      fadeSpanPx={180}  
    />
  </section>
    <div class="fixed inset-0 z-50 flex items-center justify-center pointer-events-none">
    <div class="w-[80vw] max-w-[600px] aspect-[4/3]">
      <FiveImageSequencer
        sources={sources}
        fps={24}
        config={seqConfig}
        class="w-full h-full"
        fadeEnabled={true}
        fadeScrollVh={0.5} 
        fadeMode="in"
        minOpacity={0}
        maxOpacity={1}
      />
    </div>
  </div>  
</Base>


<ScrollSpacer size="120vh" />

<section id="enter-stage" class="relative h-[60vh]">
  <!-- Co-transform overlay and slot so alignment never drifts -->
  <div class="overlay-group absolute inset-0 origin-top" style={`transform: scale(${0.5}, ${0.5});`}>
    <img
      src={overlay2.src /* or overlayPng */}
      alt=""
      class="absolute inset-0 w-full h-full object-fill pointer-events-none z-0"
    />

    <!-- Your calibrated TV screen slot (clip if you want nothing outside) -->
    <div class="tv-screen absolute z-[1]"
         style={`left:${screenLeft}; top:${screenTop}; width:${screenWidth}; height:${screenHeight}; `}>

      <ChoiceCarousel
        class="fill-slot-center"
        targetSelector="#enter-stage"
        items={items}
        leftArrow={bigarrow}
        rightArrow={bigarrow}

        top="0" left="0" right="0" bottom="0"
        centerX={false} centerY={false}
        offsetX="0" offsetY="0"

        mode="fill"
        frameMaxWidth="100%"
        frameRadius={12}
        imageFit="contain"  
        imageScale={1}     

        leftX="-126%"  leftY="341.5%"  leftScale={1.05}
        rightX="126%"  rightY="340%"  rightScale={1.05}
        arrowButtonSize="56px"
        arrowIconWidth="34px"

        navigateOnClick={false}
        enablePreload={true}
      />
    </div>
  </div>

  <HoldEnterButton
    durationMs={3000}
    targetSelector="#enter-stage"
    label="ENTER"
    strokeRadius={10}
    hideOnComplete={true}
    icon={rightIcon}
    strokeStart="bottom-center"
  />
</section>

<ScrollSpacer size="50vh" />

<style is:global>
  /* Simple centering helper; no sizing overrides */
  .fill-slot-center{ display:grid; place-items:center; height:100%; }
</style>
